From b4e212c63e8b5c337218af19267e57e01264d29f Mon Sep 17 00:00:00 2001
From: Kevron Rees <tripzero.kev@gmail.com>
Date: Wed, 23 Sep 2015 14:34:06 -0700
Subject: [PATCH 3/7] ocpayload: free out if cannot allocate

Upstream Status: Pending
---
 resource/csdk/stack/src/ocpayloadparse.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/resource/csdk/stack/src/ocpayloadparse.c b/resource/csdk/stack/src/ocpayloadparse.c
index 7d54fde..79d6df6 100644
--- a/resource/csdk/stack/src/ocpayloadparse.c
+++ b/resource/csdk/stack/src/ocpayloadparse.c
@@ -170,6 +170,7 @@ static OCStackResult OCParseDiscoveryPayload(OCPayload** outPayload, CborValue*
         OCResourcePayload* resource = (OCResourcePayload*)OICCalloc(1, sizeof(OCResourcePayload));
         if(!resource)
         {
+            OICFree(out);
             OC_LOG_V(ERROR, TAG, "Memory allocation failed");
             return OC_STACK_NO_MEMORY;
         }
-- 
2.1.4

